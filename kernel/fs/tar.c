#include "tar.h"
#include <libk/kprintf.h>

#define SECTOR_SIZE 0x200

const char tar[] = {0x2e ,0x2f ,0x62 ,0x6f ,0x6f ,0x74 ,0x2e ,0x73  ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00  
  ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00  ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
  ,0x00 ,0x00 ,0x00 ,0x00 ,0x30 ,0x30 ,0x30 ,0x30  ,0x36 ,0x34 ,0x34 ,0x00 ,0x30 ,0x30 ,0x30 ,0x31  
  ,0x37 ,0x35 ,0x30 ,0x00 ,0x30 ,0x30 ,0x30 ,0x31  ,0x37 ,0x35 ,0x30 ,0x00 ,0x30 ,0x30 ,0x30 ,0x30  
 ,0x30 ,0x30 ,0x30 ,0x30 ,0x36 ,0x32 ,0x35 ,0x00  ,0x31 ,0x34 ,0x31 ,0x33 ,0x36 ,0x33 ,0x30 ,0x35  
  ,0x31 ,0x35 ,0x36 ,0x00 ,0x30 ,0x31 ,0x31 ,0x37  ,0x36 ,0x33 ,0x00 ,0x20 ,0x30 ,0x00 ,0x00 ,0x00  
  ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00  ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00  
,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
  ,0x00 ,0x75 ,0x73 ,0x74 ,0x61 ,0x72 ,0x20 ,0x20  ,0x00 ,0x70 ,0x69 ,0x6f ,0x74 ,0x72 ,0x6f ,0x00  
 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00  ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00  
 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00  ,0x00 ,0x70 ,0x69 ,0x6f ,0x74 ,0x72 ,0x6f ,0x00 
  ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00  ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00  };


void* search_file(char* name) {
    char* pos = tar;
    int empty_sectors = 0;
    struct tar_t* header; 

    while (empty_sectors < 2) {
        header = (struct tar_t*) tar;
        kprintf("us %s", header->ustarzz);
        char* pz = tar;
        pz += 0x101;
        kprintf("us %s", pz);
        kprintf("tarp %d hp %d", tar, header->ustarzz);
        return;
    }
    return pos; //what if not found?
}

uint8_t open(char* path) {
    
}